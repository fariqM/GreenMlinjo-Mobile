<template>
	<v-col cols="6" sm="5" md="5" class="py-2" style="padding: 10px 5px 5px 5px">
		<skeleton width="100%" height="12rem" :radius="3" v-if="skeleton" />
		<v-lazy
			v-else
			:v-model="false"
			:options="{
				threshold: 0.5,
			}"
			width="100%"
		>
			<v-card class="mx-auto" max-width="344" elevation="2" outlined>
				<v-list link class="pa-0" style="display: block">
					<div class="d-flex justify-end">
						<v-img :src="url + images[0].url" height="100px" width="100px">
							<template v-slot:placeholder>
								<v-row class="fill-height ma-0" align="center" justify="center">
									<v-progress-circular
										indeterminate
										color="primary"
									></v-progress-circular>
								</v-row>
							</template>
						</v-img>
						<div style="position: absolute">
							<div>
								<v-btn
									class="pa-0 mt-1 mr-1"
									style="min-width: 35px; background-color: #ffffffa1"
									id="MyBTN12212"
								>
									<!-- <v-icon v-if="favourite.length === 0" color="white"> mdi-cards-heart-outline </v-icon> -->
									<!-- <v-icon >  </v-icon> -->
									<div style="height: 30px; width: 30px" @click="clickFav(product_id)">
										<heart-icon  v-if="favourite.length === 0" :isFavourite="false" :product_id="product_id"/>
										<heart-icon v-else :isFavourite="true" :product_id="product_id"/>
										<!-- <cart-icon></cart-icon> -->
									</div>
								</v-btn>
							</div>
						</div>
					</div>
				</v-list>

				<v-list-item link class="pa-0 pb-1">
					<div style="width: 100%">
						<v-card-title
							style="
								font-size: 0.8rem;
								padding: 2px 5px;
								white-space: nowrap;
								overflow: hidden;
								text-overflow: ellipsis;
								display: flow-root;
							"
						>
							{{ title }}
						</v-card-title>
						<v-card-subtitle
							style="padding: 5px 5px; color: #8b8b8b; font-size: 0.7rem"
						>
							{{ min_qty_per_unit }}-{{ max_qty_per_unit }} {{ sub_unit }}/{{
								unit
							}}
						</v-card-subtitle>
						<div
							class="pl-1"
							style="
								font-weight: 500;
								font-size: 0.9rem;
								white-space: nowrap;
								overflow: hidden;
								text-overflow: ellipsis;
								color: #09893c;
							"
						>
							Rp {{ numberWithCommas(min_price) }} - Rp
							{{ numberWithCommas(max_price) }}
						</div>
						<div
							class="pl-1 normal-text"
							style="font-weight: 500; font-size: 0.775rem"
						>
							/{{ unit }}
						</div>
					</div>
				</v-list-item>

				<v-divider class="mb-1"></v-divider>

				<v-card-actions
					style="padding: 0px 0px"
					class="d-flex justify-center py-1"
				>
					<v-btn text x-small outlined color="primary" class="pa-4">
						<v-icon x-small color="primary" class="mr-2">mdi-plus</v-icon>
						Keranjang
					</v-btn>
				</v-card-actions>
			</v-card>
		</v-lazy>
	</v-col>
</template>

<script>
import HeartIcon from "../../components/icon/Heart.vue";
import CartIcon from "../../components/icon/Cart.vue"

export default {
	components: {
		HeartIcon,
		CartIcon
	},
	data() {
		return {
			url: __BASE_URL__,
		};
	},
	props: {
		testing_log: String,
		title: String,
		unit: String,
		sub_unit: String,
		min_qty_per_unit: Number,
		max_qty_per_unit: Number,
		min_price: Number,
		max_price: Number,
		product_id: Number,
		skeleton: Boolean,
		favourite: Array,
		images: Array,
	},
	methods: {
		numberWithCommas(x) {
			var parts = x.toString().split(".");
			parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			return parts.join(".");
		},
		addFavourite(product_id) {
			this.$store.dispatch("favourites/addFavourites", product_id);
		},
		clickFav(product_id) {
			this.$store.dispatch("favourites/addFavourites", product_id).then(response => {
				// console.log(response);
			}).catch(e => {
				console.log(e);
			})
			console.log("ok");
		},
	},
};
</script>

<style>
</style>